Ext.namespace('Js.Center.Business');Js.Center.Business.WhiteURL='URL/BlackWhilteList/WhilteQuery.ashx';Js.Center.Business.WhiteUpdateURL='URL/BlackWhilteList/WhilteUpdate.ashx';Ext.namespace('Js.Center.Business.WhitelistAdd');Js.Center.Business.WhitelistAdd.info=function(node){if(Ext.get("Js.Center.Business.WhitelistAdd.MainPanel")==null){Js.Center.Common.ServiceCodeStore.reload();var _pageSize=12;Js.Center.Business.WhitelistAdd.Infostore=new WXTL.Widgets.CommonData.GroupingStore({proxy:new Ext.data.HttpProxy({url:Js.Center.Business.whiteURL,method:"POST"}),reader:new Ext.data.JsonReader({fields:["numsvcid","vc2backuppath","vc2mode","numdepartid","numlogid","numuserid","datcreattime","datmodifytime","numtotalnum","numsuccessnum","vc2filename","numlisttype","numsrc","vc2username","vc2departname","numstate","vc2svcname"],root:"data",id:"numlogid",totalProperty:"totalCount"}),sortInfo:{field:'datcreattime',direction:'DESC'},baseParams:{flag:'selectlog',datcreattimestart:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),datcreattimeend:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),numsvcid:'',vc2username:'',numtypeid:'0,1'}});Js.Center.Business.WhitelistAdd.Infostore.load({params:{start:0,limit:_pageSize}});var sm=new Ext.grid.CheckboxSelectionModel({dataIndex:"numlogid"});var cm=new Ext.grid.ColumnModel([{header:"业务名称",tooltip:"业务名称",dataIndex:"vc2svcname",hidden:"true",sortable:true},{header:"操作部门",tooltip:"操作部门",dataIndex:"vc2departname",sortable:true},{header:"总数",tooltip:"总数",dataIndex:"numtotalnum",sortable:true},{header:"成功数",tooltip:"成功数",dataIndex:"numsuccessnum",sortable:true},{header:"处理状态",tooltip:"处理状态",dataIndex:"numstate",sortable:true},{header:"操作类型",tooltip:"操作类型",dataIndex:"numlisttype",sortable:true,renderer:function(value){if(value==0){return"添加"}if(value==1){return"退出"}}},{header:"操作人",tooltip:"操作人",dataIndex:"vc2username",sortable:true},{header:"操作时间",tooltip:"操作时间",dataIndex:"datcreattime",sortable:true},{header:"操作",tooltip:"操作",dataIndex:"numsvcid",width:50,renderer:function(value,meta,record,rowIndex,colIndex,store){return"<a href='#' onclick='doLoad(\""+Js.Center.Business.whiteURL+"\",\""+record.data.numlogid+"\")'>详情下载</a>"}}]);var userGroupGrid=new WXTL.Widgets.CommonGrid.GridPanel({id:"whitelistaddGridPanel",anchor:'100% 100%',pageSize:_pageSize,store:Js.Center.Business.WhitelistAdd.Infostore,needMenu:false,needRightMenu:false,sm:sm,cm:cm,tbar:new Ext.Toolbar({items:[{iconCls:'addicon',text:"添加",handler:function(){Js.Center.Business.WhitelistAdd.func()}},{iconCls:'deleteicon',text:"退出",handler:function(){Js.Center.Business.WhitelistDelete.func()}}]})});var selectPanel=new WXTL.Widgets.CommonPanel.QueryFormPanel({id:"whitelistaddSelectPanel",bodyStyle:"padding:10px 0 10px 15px",queryMethod:"Js.Center.Business.WhitelistAdd.queryGrid",items:[{layout:'column',items:[{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},buttonAlign:"center",items:[{xtype:"datefield",fieldLabel:"开始时间",format:'Y-m-d',labelWidth:100,readOnly:true,emptyText:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),fieldLabel:"开始时间",name:"datcreattimestart",id:"whitelistadddatcreattimestart"},{xtype:"combo",name:"numtype",fieldLabel:"操作类型",hiddenName:"whitelistaddinfovc2type",blankText:"-=请选择=-",readOnly:true,mode:"local",displayField:"vc2name",valueField:"value",triggerAction:"all",emptyText:'-=请选择=-',value:"0,1",store:new Ext.data.SimpleStore({fields:["vc2name","value"],data:[["-=请选择=-","0,1"],["添加","0"],["退出","1"]]})},{xtype:"hidden",name:"numsvcid",fieldLabel:"运营商业务",hiddenName:"whitelistaddnumsvcid",readOnly:true,mode:"local",displayField:"vc2svcname",valueField:"numsvcid",triggerAction:"all",store:Js.Center.Common.ServiceCodeStore}]},{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},buttonAlign:"center",items:[{xtype:"datefield",fieldLabel:"结束时间",labelWidth:100,format:'Y-m-d',readOnly:true,emptyText:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),name:"datcreattimeend",id:"whitelistadddatcreattimeend"}]}]}]});Js.Center.Business.WhitelistAdd.queryGrid=function(){if(selectPanel.getForm().isValid()){var datCreatTimeStart=Ext.get("whitelistadddatcreattimestart").getValue();var datCreatTimeend=Ext.get("whitelistadddatcreattimeend").getValue();var _numsvcid='';var _numtypeid=Ext.get("whitelistaddinfovc2type").getValue();var flag='selectlog';Js.Center.Business.WhitelistAdd.Infostore.baseParams={flag:flag,numtypeid:_numtypeid,datcreattimestart:datCreatTimeStart,datcreattimeend:datCreatTimeend,numsvcid:_numsvcid};Js.Center.Business.WhitelistAdd.Infostore.load({params:{start:0,limit:_pageSize}})}};Js.Center.Business.WhitelistAdd.MainPanel=new Ext.Panel({id:"Js.Center.Business.WhitelistAdd.MainPanel",frame:true,bodyBorder:false,border:false,autoScroll:true,layout:"anchor",defaults:{collapsible:true},items:[selectPanel,userGroupGrid]})};GridMain(node,Js.Center.Business.WhitelistAdd.MainPanel,"openroomiconinfo","Js.Center.Business.WhitelistAdd.Infostore")};Ext.namespace('Js.Center.Business.WhitelistAdd');Ext.QuickTips.init();Js.Center.Business.WhitelistAdd.func=function(){var addByFilePanel=new Ext.form.FormPanel({title:"文件方式",width:600,border:false,fileUpload:true,frame:true,labelWidth:80,defaults:{msgTarget:"side"},items:[{xtype:"hidden",name:"whitelistaddnumsvcid",value:"1"},{xtype:'textfield',style:'border: 1px solid #C0C0C0;height:22;cursor:hand',name:'mobilefile',fieldLabel:WXTL.Common.help.MOBILEFILE,allowBlank:false,blankText:"请选择上传文件",width:450,inputType:'file',validator:function(){var filePath=mainForm.items.items[1].getValue();if(filePath!=''){mainForm.items.items[2].el.dom.value=getFileMessage(filePath);if(checkFile(filePath)!=''){this.invalidText=checkFile(filePath);return false}else{return true}}else return false}},{xtype:'textarea',name:'filemessage',fieldLabel:'文件信息',readOnly:true,width:500,height:180},{xtype:'hidden',name:'flag',value:'insertbyfile'}]});var addByListPanel=new Ext.form.FormPanel({title:"列表方式",width:600,border:false,frame:true,labelWidth:80,defaults:{msgTarget:"side"},items:[{xtype:"hidden",name:"whitelistaddnumsvcid",value:"1"},{xtype:'textarea',name:'mobilelist',fieldLabel:WXTL.Common.help.MOBILELIST,width:300,height:200,allowBlank:false,blankText:"请输入手机号码列表",validator:function(value){return checkMobileList(value,1000)}},{xtype:'hidden',name:'flag',value:'insertbylist'}]});var mainForm=addByFilePanel.getForm();var tabPanel=new Ext.TabPanel({height:300,border:false,width:650,activeTab:0,animScroll:true,enableTabScroll:true,items:[addByFilePanel,addByListPanel],listeners:{"tabchange":function(TabPanel,Panel){mainForm=Panel.getForm();Js.Center.Business.WhitelistAdd.AddWhitelistInfoWin.mainForm=mainForm}}});Js.Center.Business.WhitelistAdd.AddWhitelistInfoWin=new WXTL.Widgets.CommonWindows.Window({title:"添加系统白名单",mainForm:mainForm,updateURL:Js.Center.Business.WhiteUpdateURL,displayStore:Js.Center.Business.WhitelistAdd.Infostore,items:[tabPanel]});Js.Center.Business.WhitelistAdd.AddWhitelistInfoWin.show()};Ext.namespace('Js.Center.Business.WhitelistDelete');Ext.QuickTips.init();Js.Center.Business.WhitelistDelete.func=function(){var addByFilePanel=new Ext.form.FormPanel({title:"文件方式",width:600,border:false,fileUpload:true,frame:true,labelWidth:80,defaults:{msgTarget:"side"},items:[{xtype:"hidden",name:"whitelistaddnumsvcid",value:"1"},{xtype:'textfield',style:'border: 1px solid #C0C0C0;height:22;cursor:hand',name:'mobilefile',fieldLabel:WXTL.Common.help.MOBILEFILE,allowBlank:false,blankText:"请选择上传文件",width:450,inputType:'file',validator:function(){var filePath=mainForm.items.items[1].getValue();if(filePath!=''){mainForm.items.items[2].el.dom.value=getFileMessage(filePath);if(checkFile(filePath)!=''){this.invalidText=checkFile(filePath);return false}else{return true}}else return false}},{xtype:'textarea',name:'filemessage',fieldLabel:'文件信息',readOnly:true,width:500,height:180},{xtype:'hidden',name:'flag',value:'deletebyfile'}]});var addByListPanel=new Ext.form.FormPanel({title:"列表方式",width:600,border:false,frame:true,labelWidth:80,defaults:{msgTarget:"side"},items:[{xtype:"hidden",name:"whitelistaddnumsvcid",value:"1"},{xtype:'textarea',name:'mobilelist',fieldLabel:WXTL.Common.help.MOBILELIST,width:300,height:200,allowBlank:false,blankText:"请输入手机号码列表",validator:function(value){return checkMobileList(value,1000)}},{xtype:'hidden',name:'flag',value:'deletebylist'}]});var mainForm=addByFilePanel.getForm();var tabPanel=new Ext.TabPanel({height:300,border:false,width:650,activeTab:0,animScroll:true,enableTabScroll:true,items:[addByFilePanel,addByListPanel],listeners:{"tabchange":function(TabPanel,Panel){mainForm=Panel.getForm();Js.Center.Business.WhitelistDelete.addwhitelistInfoWin.mainForm=mainForm}}});Js.Center.Business.WhitelistDelete.addwhitelistInfoWin=new WXTL.Widgets.CommonWindows.Window({title:"退出系统白名单",iconCls:'deleteicon',mainForm:mainForm,updateURL:Js.Center.Business.WhiteUpdateURL,displayStore:Js.Center.Business.WhitelistAdd.Infostore,items:[tabPanel]});Js.Center.Business.WhitelistDelete.addwhitelistInfoWin.show()};Ext.namespace('Js.Center.Business');Js.Center.Business.whiteURL='URL/BlackWhilteList/WhilteQuery.ashx';Js.Center.Business.WhiteUpdateURL='URL/BlackWhilteList/WhilteUpdate.ashx';Ext.namespace('Js.Center.Business.WhitelistAdd');Ext.QuickTips.init();Js.Center.Business.WhitelistAdd.func=function(){if(Js.Center.Business.WhitelistAdd.window==null){var uploadFilePanel=new WXTL.Widgets.CommonPanel.UploadLargeFilePanel({needLargfile:false,id:"Js.Center.Business.WhitelistAdd.UploadLargeFile"});var addByFilePanel=new Ext.form.FormPanel({title:"文件方式",width:600,border:false,fileUpload:true,frame:true,labelWidth:80,defaults:{msgTarget:"side"},items:[{xtype:"hidden",name:"whitelistaddnumsvcid",value:"1"},uploadFilePanel,{xtype:'hidden',name:'flag',value:'insertbyfile'}]});var addByListPanel=new Ext.form.FormPanel({title:"列表方式",width:600,border:false,frame:true,labelWidth:80,defaults:{msgTarget:"side"},items:[{xtype:"hidden",name:"whitelistaddnumsvcid",value:"1"},{xtype:'textarea',name:'mobilelist',fieldLabel:WXTL.Common.help.MOBILELIST,width:300,height:200,allowBlank:false,blankText:"请输入手机号码列表",validator:function(value){return checkMobileList(value,1000)}},{xtype:'hidden',name:'flag',value:'insertbylist'}]});var mainForm=addByFilePanel.getForm();var tabPanel=new Ext.TabPanel({height:260,border:false,width:650,activeTab:0,animScroll:true,enableTabScroll:true,items:[addByFilePanel,addByListPanel],listeners:{"tabchange":function(TabPanel,Panel){if(Js.Center.Business.WhitelistAdd.window){mainForm=Panel.getForm();Js.Center.Business.WhitelistAdd.window.mainForm=mainForm}}}});this.window=new WXTL.Widgets.CommonWindows.Window({title:"添加系统白名单",mainForm:mainForm,updateURL:Js.Center.Business.WhiteUpdateURL,displayStore:Js.Center.Business.WhitelistAdd.Infostore,items:[tabPanel],listeners:{"show":function(){Js.Center.Business.WhitelistAdd.window.items.items[0].setActiveTab(0);Js.Center.Business.WhitelistAdd.window.items.items[0].items.items[0].getForm().reset();Js.Center.Business.WhitelistAdd.window.items.items[0].items.items[1].getForm().reset()}}})}};Ext.namespace('Js.Center.Business.WhitelistAdd');Js.Center.Business.WhitelistAdd.info=function(node){if(Ext.get("Js.Center.Business.WhitelistAdd.MainPanel")==null){Js.Center.Common.ServiceCodeStore.reload();var _pageSize=12;Js.Center.Business.WhitelistAdd.Infostore=new WXTL.Widgets.CommonData.GroupingStore({proxy:new Ext.data.HttpProxy({url:Js.Center.Business.WhiteURL,method:"POST"}),reader:new Ext.data.JsonReader({fields:["numsvcid","vc2backuppath","vc2mode","numdepartid","numlogid","numuserid","datcreattime","datmodifytime","numtotalnum","numsuccessnum","numfailed","vc2filename","numlisttype","numsrc","vc2username","vc2departname","numstate","vc2svcname"],root:"data",id:"numlogid",totalProperty:"totalCount"}),sortInfo:{field:'datcreattime',direction:'DESC'},baseParams:{flag:'selectlog',datcreattimestart:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),datcreattimeend:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),numsvcid:'',vc2username:'',numtypeid:'0,1'}});Js.Center.Business.WhitelistAdd.Infostore.load({params:{start:0,limit:_pageSize}});var sm=new Ext.grid.CheckboxSelectionModel({dataIndex:"numlogid"});var cm=new Ext.grid.ColumnModel([{header:"业务名称",tooltip:"业务名称",dataIndex:"vc2svcname",hidden:"true",sortable:true},{header:"操作部门",tooltip:"操作部门",dataIndex:"vc2departname",sortable:true},{header:"总数",tooltip:"总数",dataIndex:"numtotalnum",sortable:true,renderer:function(value,meta,record,rowIndex,colIndex,store){if(value>0){return"<a href='#' onclick='exportData(\""+Js.Center.Business.WhiteURL+"\",\"id="+record.data.numlogid+"&flag=selectdesc&successtype=-1\")'>"+value+"</a>"}else{return value}}},{header:"成功数",tooltip:"成功数",dataIndex:"numsuccessnum",sortable:true,renderer:function(value,meta,record,rowIndex,colIndex,store){if(value>0){return"<a href='#' onclick='exportData(\""+Js.Center.Business.WhiteURL+"\",\"id="+record.data.numlogid+"&flag=selectdesc&successtype=1\")'>"+value+"</a>"}else{return value}}},{header:"失败数",tooltip:"失败数",dataIndex:"numfailed",sortable:true,renderer:function(value,meta,record,rowIndex,colIndex,store){if(value>0){return"<a href='#' onclick='exportData(\""+Js.Center.Business.WhiteURL+"\",\"id="+record.data.numlogid+"&flag=selectdesc&successtype=0\")'>"+value+"</a>"}else{return value}}},{header:"处理状态",tooltip:"处理状态",dataIndex:"numstate",sortable:true},{header:"操作类型",tooltip:"操作类型",dataIndex:"numlisttype",sortable:true,renderer:function(value){if(value==0){return"添加"}if(value==1){return"退出"}}},{header:"操作人",tooltip:"操作人",dataIndex:"vc2username",sortable:true},{header:"操作时间",tooltip:"操作时间",dataIndex:"datcreattime",sortable:true}]);var AddWhiteListArrInitLoadFunc=new Array();AddWhiteListArrInitLoadFunc[0]="Js.Center.Business.WhitelistAdd.func";AddWhiteListArrInitLoadFunc[1]="Js.Center.Business.WhitelistDelete.func";var userGroupGrid=new WXTL.Widgets.CommonGrid.GridPanel({id:"whitelistaddGridPanel",anchor:'100% 100%',pageSize:_pageSize,store:Js.Center.Business.WhitelistAdd.Infostore,needMenu:false,needRightMenu:false,otherInitLoadFunc:AddWhiteListArrInitLoadFunc,sm:sm,cm:cm,tbar:new Ext.Toolbar({items:[{iconCls:'addicon',text:"添加",handler:function(){Js.Center.Business.WhitelistAdd.window.show()}},{iconCls:'deleteicon',text:"退出",handler:function(){Js.Center.Business.WhitelistDelete.window.show()}}]})});var selectPanel=new WXTL.Widgets.CommonPanel.QueryFormPanel({id:"whitelistaddSelectPanel",bodyStyle:"padding:10px 0 10px 15px",queryMethod:"Js.Center.Business.WhitelistAdd.queryGrid",items:[{layout:'column',items:[{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},buttonAlign:"center",items:[{xtype:"datefield",fieldLabel:"开始时间",format:'Y-m-d',labelWidth:100,readOnly:true,emptyText:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),fieldLabel:"开始时间",name:"datcreattimestart",id:"whitelistadddatcreattimestart",validateOnBlur:false,validator:function(){var strat_time=Ext.get("whitelistadddatcreattimestart").dom.value;var end_time=Ext.get("whitelistadddatcreattimeend").dom.value;if(strat_time<=end_time){return true}else{return false}},invalidText:'结束时间不能小于开始时间！'},{xtype:"combo",name:"numtype",fieldLabel:"操作类型",hiddenName:"whitelistaddinfovc2type",blankText:"-=请选择=-",readOnly:true,mode:"local",displayField:"vc2name",valueField:"value",triggerAction:"all",emptyText:'-=请选择=-',value:"0,1",store:new Ext.data.SimpleStore({fields:["vc2name","value"],data:[["-=请选择=-","0,1"],["添加","0"],["退出","1"]]})},{xtype:"hidden",name:"numsvcid",fieldLabel:"运营商业务",hiddenName:"whitelistaddnumsvcid",readOnly:true,mode:"local",displayField:"vc2svcname",valueField:"numsvcid",triggerAction:"all",store:Js.Center.Common.ServiceCodeStore}]},{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},buttonAlign:"center",items:[{xtype:"datefield",fieldLabel:"结束时间",labelWidth:100,format:'Y-m-d',readOnly:true,emptyText:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),name:"datcreattimeend",id:"whitelistadddatcreattimeend",validateOnBlur:false,validator:function(){var strat_time=Ext.get("whitelistadddatcreattimestart").dom.value;var end_time=Ext.get("whitelistadddatcreattimeend").dom.value;if(strat_time<=end_time){return true}else{return false}},invalidText:'结束时间不能小于开始时间！'}]}]}]});Js.Center.Business.WhitelistAdd.queryGrid=function(){if(selectPanel.getForm().isValid()){var datCreatTimeStart=Ext.get("whitelistadddatcreattimestart").getValue();var datCreatTimeend=Ext.get("whitelistadddatcreattimeend").getValue();var _numsvcid='';var numTypeId=Ext.get("whitelistaddinfovc2type").getValue();var flag='selectlog';Js.Center.Business.WhitelistAdd.Infostore.baseParams={flag:flag,numtypeid:numTypeId,datcreattimestart:datCreatTimeStart,datcreattimeend:datCreatTimeend,numsvcid:_numsvcid};Js.Center.Business.WhitelistAdd.Infostore.load({params:{start:0,limit:_pageSize}})}};Js.Center.Business.WhitelistAdd.MainPanel=new Ext.Panel({id:"Js.Center.Business.WhitelistAdd.MainPanel",frame:true,bodyBorder:false,border:false,autoScroll:true,layout:"anchor",defaults:{collapsible:true},items:[selectPanel,userGroupGrid]})};GridMain(node,Js.Center.Business.WhitelistAdd.MainPanel,"openroomiconinfo","Js.Center.Business.WhitelistAdd.Infostore")};Ext.namespace('Js.Center.Business.WhitelistDelete');Ext.QuickTips.init();Js.Center.Business.WhitelistDelete.func=function(){if(Js.Center.Business.WhitelistDelete.window==null){var uploadFilePanel=new WXTL.Widgets.CommonPanel.UploadLargeFilePanel({url:'/url/upload.ashx',needLargfile:false,id:"Js.Center.Business.WhitelistDelete.UploadLargeFile"});var addByFilePanel=new Ext.form.FormPanel({title:"文件方式",width:600,border:false,fileUpload:true,frame:true,labelWidth:80,defaults:{msgTarget:"side"},items:[{xtype:"hidden",name:"whitelistaddnumsvcid",value:"1"},uploadFilePanel,{xtype:'hidden',name:'flag',value:'deletebyfile'}]});var addByListPanel=new Ext.form.FormPanel({title:"列表方式",width:600,border:false,frame:true,labelWidth:80,defaults:{msgTarget:"side"},items:[{xtype:"hidden",name:"whitelistaddnumsvcid",value:"1"},{xtype:'textarea',name:'mobilelist',fieldLabel:WXTL.Common.help.MOBILELIST,width:300,height:200,allowBlank:false,blankText:"请输入手机号码列表",validator:function(value){return checkMobileList(value,1000)}},{xtype:'hidden',name:'flag',value:'deletebylist'}]});var mainForm=addByFilePanel.getForm();var tabPanel=new Ext.TabPanel({height:260,border:false,width:650,activeTab:0,animScroll:true,enableTabScroll:true,items:[addByFilePanel,addByListPanel],listeners:{"tabchange":function(TabPanel,Panel){if(Js.Center.Business.WhitelistDelete.window){mainForm=Panel.getForm();Js.Center.Business.WhitelistDelete.window.mainForm=mainForm}}}});this.window=new WXTL.Widgets.CommonWindows.Window({title:"退出系统白名单",iconCls:'deleteicon',mainForm:mainForm,updateURL:Js.Center.Business.WhiteUpdateURL,displayStore:Js.Center.Business.WhitelistAdd.Infostore,items:[tabPanel],listeners:{"show":function(){Js.Center.Business.WhitelistDelete.window.items.items[0].setActiveTab(0);Js.Center.Business.WhitelistDelete.window.items.items[0].items.items[0].getForm().reset();Js.Center.Business.WhitelistDelete.window.items.items[0].items.items[1].getForm().reset()}}})}};Ext.namespace('Js.Center.Business.WhitelistDelete');Js.Center.Business.WhitelistDelete.info=function(node){if(Ext.get("Js.Center.Business.WhitelistDelete.mainpanel")==null){Js.Center.Common.ServiceCodeStore.reload();var _pageSize=12;Js.Center.Business.WhitelistDelete.Infostore=new WXTL.Widgets.CommonData.GroupingStore({proxy:new Ext.data.HttpProxy({url:Js.Center.Business.whiteURL,method:"POST"}),reader:new Ext.data.JsonReader({fields:["numsvcid","vc2backuppath","vc2mode","numdepartid","numlogid","numuserid","datcreattime","datmodifytime","numtotalnum","numsuccessnum","vc2filename","numlisttype","numsrc","vc2username","vc2departname","numstate","vc2svcname"],root:"data",id:"numlogid",totalProperty:"totalCount"}),baseParams:{flag:'selectlog',datcreattimestart:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),datcreattimeend:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),numsvcid:'',vc2username:'',numtypeid:1}});Js.Center.Business.WhitelistDelete.Infostore.load({params:{start:0,limit:_pageSize}});var sm=new Ext.grid.CheckboxSelectionModel({dataIndex:"numlogid"});var cm=new Ext.grid.ColumnModel([{header:"业务名称",tooltip:"业务名称",dataIndex:"vc2svcname",hidden:"true",sortable:true},{header:"部门名称",tooltip:"部门名称",dataIndex:"vc2departname",sortable:true},{header:"总数",tooltip:"总数",dataIndex:"numtotalnum",sortable:true},{header:"成功数",tooltip:"成功数",dataIndex:"numsuccessnum",sortable:true},{header:"处理状态",tooltip:"处理状态",dataIndex:"numstate",sortable:true},{header:"操作人",tooltip:"操作人",dataIndex:"vc2username",sortable:true},{header:"操作时间",tooltip:"操作时间",dataIndex:"datcreattime",sortable:true},{header:"操作",tooltip:"操作",dataIndex:"numsvcid",width:50,renderer:function(value,meta,record,rowIndex,colIndex,store){return"<a href='#' onclick='doLoad(\""+Js.Center.Business.WhiteURL+"\",\""+record.data.numlogid+"\")'>详情下载</a>"}}]);var userGroupGrid=new WXTL.Widgets.CommonGrid.GridPanel({id:"whitelistdeleteGridPanel",anchor:'100% 100%',pageSize:_pageSize,store:Js.Center.Business.WhitelistDelete.Infostore,needMenu:false,needRightMenu:false,sm:sm,cm:cm,tbar:new Ext.Toolbar({items:[{iconCls:'deleteicon',text:"退出白名单",handler:function(){Js.Center.Business.WhitelistDelete.func()}}]})});Js.Center.Common.UserGroupStore.load();var selectPanel=new WXTL.Widgets.CommonPanel.QueryFormPanel({id:"whitelistdeleteSelectPanel",queryMethod:"Js.Center.Business.WhitelistDelete.queryGrid",items:[{layout:'column',items:[{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},buttonAlign:"center",bodyStyle:"padding:10px 0 10px 15px",items:[{xtype:"datefield",fieldLabel:"开始时间",format:'Y-m-d',labelWidth:100,bodyStyle:'padding:5px 5px 0',readOnly:true,emptyText:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),fieldLabel:"开始时间",name:"datcreattimestart",id:"whitelistdeletedatcreattimestart",validateOnBlur:false,validator:function(){var strat_time=Ext.get("whitelistadddatcreattimestart").dom.value;var end_time=Ext.get("whitelistadddatcreattimeend").dom.value;if(strat_time<=end_time){return true}else{return false}},invalidText:'结束时间不能小于开始时间！'},{xtype:"xComboBox",name:"numsvcid",fieldLabel:"选择业务",hiddenName:"whitelistdeletenumsvcid",readOnly:true,mode:"local",displayField:"vc2svcname",valueField:"numsvcid",triggerAction:"all",store:Js.Center.Common.ServiceCodeStore}]},{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},buttonAlign:"center",bodyStyle:"padding:10px 0 10px 15px",items:[{xtype:"datefield",fieldLabel:"结束时间",labelWidth:100,format:'Y-m-d',bodyStyle:'padding:5px 5px 0',readOnly:true,emptyText:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),name:"datcreattimeend",id:"whitelistdeletedatcreattimeend",validateOnBlur:false,validator:function(){var strat_time=Ext.get("whitelistadddatcreattimestart").dom.value;var end_time=Ext.get("whitelistadddatcreattimeend").dom.value;if(strat_time<=end_time){return true}else{return false}},invalidText:'结束时间不能小于开始时间！'}]}]}]});Js.Center.Business.WhitelistDelete.queryGrid=function(){if(selectPanel.getForm().isValid()){var datCreatTimeStart=Ext.get("whitelistdeletedatcreattimestart").getValue();var datCreatTimeend=Ext.get("whitelistdeletedatcreattimeend").getValue();var _numsvcid=Ext.get("whitelistdeletenumsvcid").getValue();var flag='selectlog';Js.Center.Business.WhitelistDelete.Infostore.baseParams={flag:flag,numtypeid:1,datcreattimestart:datCreatTimeStart,datcreattimeend:datCreatTimeend,numsvcid:_numsvcid};Js.Center.Business.WhitelistDelete.Infostore.load({params:{start:0,limit:_pageSize}})}};Js.Center.Business.WhitelistDelete.MainPanel=new Ext.Panel({id:"Js.Center.Business.WhitelistDelete.mainpanel",frame:true,bodyBorder:false,border:false,autoScroll:true,layout:"anchor",defaults:{collapsible:true},items:[selectPanel,userGroupGrid]})};GridMain(node,Js.Center.Business.WhitelistDelete.MainPanel,"openroomiconinfo","Js.Center.Business.WhitelistDelete.Infostore")};