Ext.namespace('Js.Center.System.SystemLog.SystemSet');Js.Center.System.SystemLog.SystemSet.Info=function(node){var systemSetForm=new Ext.form.FormPanel({title:'系统设置',anchor:'100%',layout:'fit',frame:true,labelWidth:175,height:150,items:[{layout:'column',items:[{xtype:"hidden",name:"flag",value:"updatemonitorbackuptimeconfig"},{xtype:"hidden",name:"numconfigid",value:NUMSYSTEMCONFIGID},{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},buttonAlign:"center",bodyStyle:"padding:10px 0 10px 15px",items:[{xtype:"numberfield",name:"fgjj_special_monitorbackuptime",fieldLabel:"<font color=red>监控日志备份间隔时间(天)</font>",allowBlank:false,blankText:"此项不允许为空",regex:WXTL.Common.regex.Number,regexText:"该项只能输入大于0的整数",minValue:1,maxLength:10},{xtype:"numberfield",name:"random_display",fieldLabel:"<font color=red>随机抽检行数</font>",allowBlank:false,blankText:"此项不允许为空",regex:WXTL.Common.regex.Number,regexText:"该项只能输入大于0的整数",minValue:1,maxLength:4}]}]}],buttons:[{text:"保存信息",minWidth:70,handler:saveClientMonitorSet},{text:"重置",minWidth:70,qtip:"重置数据",handler:function(){systemSetForm.getForm().reset();queryClientMonitorSetInfo();}}]});var mainPanel=new Ext.Panel({frame:true,bodyBorder:false,border:false,autoScroll:true,layout:"anchor",defaults:{collapsible:true},items:[systemSetForm]});GridMain(node,mainPanel,"openroomiconinfo");queryClientMonitorSetInfo();function queryClientMonitorSetInfo(){var reader=new Ext.data.JsonReader({totalProperty:'totalProperty',root:'data',fields:["numconfigid","fgjj_special_monitorbackuptime","random_display"]});var conn=Ext.lib.Ajax.getConnectionObject().conn;conn.open("POST",Js.Center.System.SystemLog.QueryConfigURL+"?flag=queryconfig&numconfigid="+NUMSYSTEMCONFIGID,false);conn.send(null);var response=Ext.decode(conn.responseText);if(!response.success&&response.info=="对不起，您没有登录！"){Ext.Msg.alert("温馨提示","对不起，您的信息已过期请重新登录!",function(){window.location.href="login.htm"})}else{var responses=reader.readRecords(Ext.decode(conn.responseText));if(response.success){systemSetForm.getForm().loadRecord(responses.records["0"])}}}function saveClientMonitorSet(){if(systemSetForm.getForm().isValid()){Ext.MessageBox.show({msg:'正在保存，请稍等...',progressText:'Saving...',width:300,wait:true,waitConfig:{interval:200},icon:'download',animEl:'saving'});setTimeout(function(){Ext.MessageBox.hide()},300000);systemSetForm.getForm().submit({url:Js.Center.System.SystemLog.UpdateConfigURL,method:"POST",success:function(form,action){if(action.response.responseText!=""){var objJson=Ext.util.JSON.decode(action.response.responseText);var falg=objJson.success;if(falg==true){Ext.Msg.alert("温馨提示","操作成功了!");systemSetForm.getForm().reset();queryClientMonitorSetInfo()}else Ext.Msg.alert('温馨提示',objJson.info)}else Ext.Msg.alert("温馨提示","操作成功了!")},failure:function(form,action){var objJson=Ext.util.JSON.decode(action.response.responseText);Ext.Msg.alert('温馨提示',objJson.info)}})}}};Ext.namespace('Js.Center.System.SystemLog');Js.Center.System.SystemLog.QueryConfigURL="URL/Monitor/QueryConfig.ashx";Js.Center.System.SystemLog.UpdateConfigURL="URL/Monitor/UpdateConfig.ashx";Js.Center.System.SystemLog.QueryLogURL="URL/Monitor/Query.ashx";