Ext.namespace('Js.Center.YXTStatistics.mtByCustomer');Js.Center.YXTStatistics.mtByCustomer.info=function(node){if(Ext.get("Js.Center.YXTStatistics.mtByCustomer.mainpanel")==null){var _pageSize=-1;Js.Center.YXTStatistics.mtByCustomer.querydate=1;Js.Center.YXTStatistics.mtByCustomer.SMSInfostore=new WXTL.Widgets.CommonData.GroupingStore({proxy:new Ext.data.HttpProxy({url:Js.Center.Statistics.YXTStatisticsMtURL,method:"POST"}),reader:new Ext.data.JsonReader({fields:["datstat","numorder","numuserid","vc2username","numall","numsuccess","numfailed","numnoreport","num_rate","numdepartid","vc2departname","vc2opname","num_all_fee"],root:"data",id:"numlogid",totalProperty:"totalCount"}),sortInfo:{field:'datstat',direction:'ASC'},baseParams:{start:0,limit:_pageSize,datcreattimestart:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),datcreattimeend:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),numsmstype:'',vc2departname:'',vc2username:'',querydate:Js.Center.YXTStatistics.mtByCustomer.querydate,flag:'countbycustomer'}});var SMSsm=new Ext.grid.CheckboxSelectionModel({dataIndex:"numlogid"});var SMScm=new Ext.grid.ColumnModel([{header:"统计时间",tooltip:"统计时间",dataIndex:"datstat",sortable:true},{header:"用户名称",tooltip:"用户名称",dataIndex:"vc2username",sortable:true},{header:"部门顺序号",tooltip:"部门顺序号",dataIndex:"numorder",sortable:true},{header:"部门名称",tooltip:"部门名称",dataIndex:"vc2departname",sortable:true},{header:"运营商名称",tooltip:"运营商名称",dataIndex:"vc2opname",sortable:true},{header:"总数",tooltip:"总数",dataIndex:"numall",sortable:true},{header:"成功数",tooltip:"成功数",dataIndex:"numsuccess",sortable:true},{header:"失败数",tooltip:"失败数",dataIndex:"numfailed",sortable:true},{header:"未知数",tooltip:"未知数",dataIndex:"numnoreport",sortable:true},{header:"成功率",tooltip:"成功率",dataIndex:"num_rate",sortable:true},{header:"费用（元）",tooltip:"费用（元）",dataIndex:"num_all_fee",sortable:true}]);var userGroupSMSGrid=new WXTL.Widgets.CommonGrid.GridPanel({anchor:'100% 100%',title:'短信用户统计信息',needPage:false,store:Js.Center.YXTStatistics.mtByCustomer.SMSInfostore,needMenu:false,needRightMenu:false,sm:SMSsm,cm:SMScm,tbar:new Ext.Toolbar({items:[{iconCls:'exporticon',text:"数据导出",handler:function(){windowOpen(Js.Center.Statistics.YXTStatisticsMtURL+"?"+"flag=loadbycustomer&start=0&limit=-1&datcreattimestart="+Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatStart").getValue()+"&datcreattimeend="+Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatEnd").getValue()+"&vc2departname="+encodeURI(Ext.get("Js.Center.YXTStatistics.mtByCustomer.DepartmentName").getValue())+"&vc2username="+encodeURI(Ext.get("Js.Center.YXTStatistics.mtByCustomer.UserName").getValue()),400,300)}}]})});Js.Center.YXTStatistics.mtByCustomer.MMSInfostore=new WXTL.Widgets.CommonData.GroupingStore({proxy:new Ext.data.HttpProxy({url:Js.Center.MMSStatistics.YXTMMSStatisticsMtURL,method:"POST"}),reader:new Ext.data.JsonReader({fields:["datstat","numorder","numuserid","vc2username","numall","numsuccess","numfailed","numnoreport","num_rate","numdepartid","vc2departname","vc2opname","num_all_fee"],root:"data",id:"numlogid",totalProperty:"totalCount"}),sortInfo:{field:'datstat',direction:'ASC'},baseParams:{start:0,limit:_pageSize,datcreattimestart:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),datcreattimeend:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),vc2departname:'',vc2username:'',flag:'countbycustomer'}});var MMSsm=new Ext.grid.CheckboxSelectionModel({dataIndex:"numlogid"});var MMScm=new Ext.grid.ColumnModel([{header:"统计时间",tooltip:"统计时间",dataIndex:"datstat",sortable:true},{header:"用户名称",tooltip:"用户名称",dataIndex:"vc2username",sortable:true},{header:"部门顺序号",tooltip:"部门顺序号",dataIndex:"numorder",sortable:true},{header:"部门名称",tooltip:"部门名称",dataIndex:"vc2departname",sortable:true},{header:"运营商名称",tooltip:"运营商名称",dataIndex:"vc2opname",sortable:true},{header:"总数",tooltip:"总数",dataIndex:"numall",sortable:true},{header:"成功数",tooltip:"成功数",dataIndex:"numsuccess",sortable:true},{header:"失败数",tooltip:"失败数",dataIndex:"numfailed",sortable:true},{header:"未知数",tooltip:"未知数",dataIndex:"numnoreport",sortable:true},{header:"成功率",tooltip:"成功率",dataIndex:"num_rate",sortable:true},{header:"费用（元）",tooltip:"费用（元）",dataIndex:"num_all_fee",sortable:true}]);var userGroupMMSGrid=new WXTL.Widgets.CommonGrid.GridPanel({anchor:'100% 100%',title:'彩信用户统计信息',needPage:false,store:Js.Center.YXTStatistics.mtByCustomer.MMSInfostore,needMenu:false,needRightMenu:false,sm:MMSsm,cm:MMScm,tbar:new Ext.Toolbar({items:[{iconCls:'exporticon',text:"数据导出",handler:function(){windowOpen(Js.Center.MMSStatistics.YXTMMSStatisticsMtURL+"?"+"flag=loadbycustomer&start=0&limit=-1&datcreattimestart="+Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatStart").getValue()+"&datcreattimeend="+Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatEnd").getValue()+"&vc2departname="+encodeURI(Ext.get("Js.Center.YXTStatistics.mtByCustomer.DepartmentName").getValue())+"&vc2username="+encodeURI(Ext.get("Js.Center.YXTStatistics.mtByCustomer.UserName").getValue()),400,300)}}]})});var mtByDepStartdate=new Ext.form.DateField({fieldLabel:"开始时间",format:'Y-m-d',labelWidth:100,bodyStyle:'padding:5px 5px 0',readOnly:true,emptyText:Ext.util.Format.date(WXTL.Common.dateTime.addDay(WXTL.Common.dateTime.getNow(),-7),'Y-m-d'),fieldLabel:"开始时间",name:"datcreattimestart",id:"Js.Center.YXTStatistics.mtByCustomer.DatStart",validateOnBlur:false,validator:function(){var strat_time=Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatStart").dom.value;var end_time=Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatEnd").dom.value;if(strat_time<=end_time){return true}else{return false}},invalidText:'结束时间不能小于开始时间！'});var mtByDepEnddate=new Ext.form.DateField({fieldLabel:"结束时间",labelWidth:100,format:'Y-m-d',bodyStyle:'padding:5px 5px 0',readOnly:true,emptyText:Ext.util.Format.date(WXTL.Common.dateTime.getNow(),'Y-m-d'),name:"datcreattimeend",id:"Js.Center.YXTStatistics.mtByCustomer.DatEnd",validateOnBlur:false,validator:function(){var strat_time=Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatStart").dom.value;var end_time=Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatEnd").dom.value;if(strat_time<=end_time){return true}else{return false}},invalidText:'结束时间不能小于开始时间！'});var selectPanel=new WXTL.Widgets.CommonPanel.QueryFormPanel({bodyStyle:"padding:10px 0 10px 15px",buttonAlign:"center",height:150,queryMethod:"Js.Center.YXTStatistics.mtByCustomer.queryGrid",items:[{layout:'column',items:[{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},items:[mtByDepStartdate,{xtype:"textfield",name:"vc2departname",id:"Js.Center.YXTStatistics.mtByCustomer.DepartmentName",fieldLabel:"部门名称",regex:WXTL.Common.regex.Illegal,regexText:WXTL.Common.regexText.IllegalText,maxLength:15,maxLengthText:'长度不能超过15！'}]},{columnWidth:.5,layout:'form',defaultType:"textfield",defaults:{anchor:"90%",msgTarget:"side"},items:[mtByDepEnddate,{xtype:"textfield",name:"vc2username",id:"Js.Center.YXTStatistics.mtByCustomer.UserName",fieldLabel:"用户名",regex:WXTL.Common.regex.Illegal,regexText:WXTL.Common.regexText.IllegalText,maxLength:15,maxLengthText:'长度不能超过15！'}]}]}]});Js.Center.YXTStatistics.mtByCustomer.queryGrid=function(){if(selectPanel.getForm().isValid()){var _datCreatTimeStart=Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatStart").getValue();var _datCreatTimeend=Ext.get("Js.Center.YXTStatistics.mtByCustomer.DatEnd").getValue();var _vc2departname=Ext.get("Js.Center.YXTStatistics.mtByCustomer.DepartmentName").getValue();var _username=Ext.get("Js.Center.YXTStatistics.mtByCustomer.UserName").getValue();var _flag='countbycustomer';Js.Center.YXTStatistics.mtByCustomer.SMSInfostore.baseParams={flag:_flag,datcreattimestart:_datCreatTimeStart,datcreattimeend:_datCreatTimeend,vc2departname:_vc2departname,vc2username:_username};Js.Center.YXTStatistics.mtByCustomer.SMSInfostore.load({params:{start:0,limit:_pageSize}});Js.Center.YXTStatistics.mtByCustomer.MMSInfostore.baseParams={flag:_flag,datcreattimestart:_datCreatTimeStart,datcreattimeend:_datCreatTimeend,vc2departname:_vc2departname,vc2username:_username};Js.Center.YXTStatistics.mtByCustomer.MMSInfostore.load({params:{start:0,limit:_pageSize}})}};Js.Center.YXTStatistics.mtByCustomer.MainPanel=new Ext.Panel({id:"Js.Center.YXTStatistics.mtByCustomer.mainpanel",frame:true,bodyBorder:false,border:false,autoScroll:true,layout:"anchor",defaults:{collapsible:true},items:[selectPanel,userGroupSMSGrid,userGroupMMSGrid]})};GridMain(node,Js.Center.YXTStatistics.mtByCustomer.MainPanel,"openroomiconinfo","Js.Center.YXTStatistics.mtByCustomer.MMSInfostore","Js.Center.YXTStatistics.mtByCustomer.queryGrid()")};Ext.namespace('Js.Center.YXTStatistics.Mt');Js.Center.MMSStatistics.MMSStatisticsMtURL='URL/MMSStatistics/mt/MMSStatisticMTQuery.ashx';Js.Center.MMSStatistics.YXTMMSStatisticsMtURL='URL/MMSStatistics/mt/YXTMMSStatisticMTQuery.ashx';Js.Center.Statistics.StatisticsMtURL='URL/statistics/mt/statisticmtquery.ashx';Js.Center.Statistics.YXTStatisticsMtURL='URL/statistics/mt/YXTStatisticMtQuery.ashx';