Ext.namespace('Js.Center.Statistics.ChannelStatisticsYear');Js.Center.Statistics.ChannelStatisticsYear.info = function(node){    if (Ext.get("Js.Center.Statistics.ChannelStatisticsYear.MainPanel") == null) {        var _pageSize = -1;		//标识为短信通道类型		var channelType = 1;        Js.Center.Statistics.ChannelStatisticsYear.Infostore = new WXTL.Widgets.CommonData.GroupingStore({            proxy: new Ext.data.HttpProxy({                url: Js.Center.Statistics.ChannelStatisticsURL,                method: "POST"            }),            reader: new Ext.data.JsonReader({                fields: ["numrowasdf", "datstat","vc2svcname","numall","numsuccess","numfailed","numfeeall","num_rate"],                root: "data",                id: "numrowasdf",                totalProperty: "totalCount"                        }),
            sortInfo: {
                field: 'vc2svcname',
                direction: 'DESC'
            },            baseParams: {                start: 0,
                limit: _pageSize,                datstarttime: '',                datendtime: '',				vc2svcname: '',				channelType: channelType,                flag: 'getservicecodecountbyyear'            }        });        Js.Center.Statistics.ChannelStatisticsYear.Infostore.load({
            params: {
                datstarttime: '',                datendtime: '',				vc2svcname: '',				channelType: channelType,                flag: 'getservicecodecountbyyear' 
            }
        });        //==============================================================列选择模式        var sm = new Ext.grid.CheckboxSelectionModel({            dataIndex: "numrowasdf"        });        //==============================================================列头        var cm = new Ext.grid.ColumnModel([{            header: "统计时间",            tooltip: "统计时间",            dataIndex: "datstat",            sortable: true        },{            header: "通道名称",            tooltip: "通道名称",            dataIndex: "vc2svcname",            sortable: true        }, {            header: "总数",            tooltip: "总数",            dataIndex: "numall",            sortable: true        }, {            header: "成功数",            tooltip: "成功数",            dataIndex: "numsuccess",            sortable: true        }, {            header: "失败数",            tooltip: "失败数",            dataIndex: "numfailed",            sortable: true        },{            header: "成功率",            tooltip: "成功率",            dataIndex: "num_rate",            sortable: true//,//            renderer: function(value){//                var rs = value * 100;//                return Math.round(rs * 100) / 100 + "%";//            }        },{            header: "费用",            tooltip: "费用",            dataIndex: "numfeeall",            sortable: true        }]);                //==============================================================定义grid        var userGroupGrid = new WXTL.Widgets.CommonGrid.GridPanel({            anchor: '100% 100%',            //pageSize: _pageSize,
			needPage:false,            store: Js.Center.Statistics.ChannelStatisticsYear.Infostore,            needMenu: false,            needRightMenu: false,            sm: sm,            cm: cm,            tbar: new Ext.Toolbar({                items: [{                    iconCls: 'exporticon',                    text: "数据导出",                    handler: function(){                        exportData(Js.Center.Statistics.ChannelStatisticsURL, "flag=statisticmtyearexport&start=0&limit=-1&datstarttime=" + Ext.get("smsstatisticsYearStartDateId").getValue() + "&datendtime=" + Ext.get("smsstatisticsYearEndDateId").getValue()+"&vc2svcname=" + Ext.get("smsvc2svcnameYearId").getValue() + "&channelType=" + channelType);                    }                }]            })        });        //=============================================================定义formpanel        var statisticsYearStartDate = new Ext.form.DateField({            fieldLabel: "开始时间",            format: 'Y-m-d',            labelWidth: 100,            bodyStyle: 'padding:5px 5px 0',            readOnly: true,            fieldLabel: "开始时间",            name: "statisticsYearStartDate",            id: "smsstatisticsYearStartDateId",			emptyText:''                 });        var statisticsYearEndDate = new Ext.form.DateField({            fieldLabel: "结束时间",            labelWidth: 100,            format: 'Y-m-d',            bodyStyle: 'padding:5px 5px 0',            readOnly: true,            emptyText:'',            name: "statisticsYearEndDate",            id: "smsstatisticsYearEndDateId",            validateOnBlur: false,
            validator: function(){
            var strat_time = Ext.get("smsstatisticsYearStartDateId").dom.value;
            var end_time = Ext.get("smsstatisticsYearEndDateId").dom.value;
            if (strat_time <= end_time) {
                return true;
            }
            else {
                return false;
            }
            },
            invalidText: '结束时间不能小于开始时间！'        });        var selectPanel = new WXTL.Widgets.CommonPanel.QueryFormPanel({            bodyStyle: "padding:10px 0 10px 15px",            buttonAlign: "center",            height: 150,            //查询调用的方法            queryMethod: "Js.Center.Statistics.ChannelStatisticsYear.queryGrid",            items: [{                layout: 'column',                items: [{                    columnWidth: .5,                    layout: 'form',                    defaultType: "textfield",                    //锚点布局-                    defaults: {                        anchor: "90%",                        msgTarget: "side"                    },                    items: [statisticsYearStartDate]                }, {                    columnWidth: .5,                    layout: 'form',                    defaultType: "textfield",                    //锚点布局-                    defaults: {                        anchor: "90%",                        msgTarget: "side"                    },                    items: [statisticsYearEndDate]                }, {                    columnWidth: .5,                    layout: 'form',                    defaultType: "textfield",                    //锚点布局-                    defaults: {                        anchor: "90%",                        msgTarget: "side"                    },                    items: [{						xtype:'textfield',						fieldLabel: '通道名称',						name: 'vc2svcname',						id: 'smsvc2svcnameYearId'					}]                }]            }]        });                //============================================================== 定义查询按钮事件方法        Js.Center.Statistics.ChannelStatisticsYear.queryGrid = function(){        if (selectPanel.getForm().isValid()) {            var datCreatTimeStart = Ext.get("smsstatisticsYearStartDateId").getValue();            var datCreatTimeend = Ext.get("smsstatisticsYearEndDateId").getValue();            var vc2svcname = Ext.get("smsvc2svcnameYearId").getValue();            var flag = 'getservicecodecountbyyear';            Js.Center.Statistics.ChannelStatisticsYear.Infostore.baseParams = {                flag: flag,                datstarttime: datCreatTimeStart,                datendtime: datCreatTimeend,				channelType: channelType,				vc2svcname: vc2svcname            };            Js.Center.Statistics.ChannelStatisticsYear.Infostore.load({                params: {                    start: 0,                    limit: _pageSize                }            });            }        };                //============================================================================定义主panel        Js.Center.Statistics.ChannelStatisticsYear.MainPanel = new Ext.Panel({            id: "Js.Center.Statistics.ChannelStatisticsYear.MainPanel",            frame: true, // 渲染面板            bodyBorder: false,            border: false,            autoScroll: true, // 自动显示滚动条            layout: "anchor",            defaults: {                collapsible: true // 允许展开和收缩            },            items: [selectPanel, userGroupGrid]        })    };    //============================================================================绑定到center    GridMain(node, Js.Center.Statistics.ChannelStatisticsYear.MainPanel, "openroomiconinfo", "Js.Center.Statistics.ChannelStatisticsYear.Infostore");};